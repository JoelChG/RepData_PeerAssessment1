---
title: 'Reproducible Research: Peer Assessment 1'
author: "Joel Chávez Gómez"
output:
  html_document:
    keep_md: yes
---


## Loading and preprocessing the data
First, the data is loaded with the `read.csv()` function. The csv file is in a 
zip file, so we will unzip it before with the `unzip()` function, and save it
in the object `data`, then we will use the `head()` function with `data` to look
at the first rows:
```{r, echo = TRUE, cache = TRUE}
unzip("./activity.zip")
data <- read.csv("activity.csv", header = TRUE)
head(data)
```
The data set contains three variables:  
        1. **steps**: Number of steps taking in a 5-minute interval (missing values are coded
as NA).  
        2. **date**: The date on which the measurement was taken in YYYY-MM-DD format.  
        3. **interval**: Identifier for the 5-minute interval in which measurement was taken.  

Now we will use the `dim()` function to look at the dimensions of the data set:
```{r, echo = TRUE, cache = TRUE}
dim(data)
```
As we can see, the data set contains 17,568 observations of the 3 previously
mentioned variables. Now let's take a look at the structure of the variables 
with the `str()` function:
```{r, echo = TRUE, cache = TRUE}
str(data)
```
The steps and interval variable are both integers, but the date variable is a 
character variable, so we will change it to a date variable with the function
`as.Date()` specifying the format (YYY-MM-DD):
```{r, echo = TRUE, cache = TRUE}
data$date <- as.Date(data$date, "%Y-%m-%d")
str(data)
```
Now the date variable is in Date format, this will make data manipulation much
easier. It's important to keep in mind that there are missing values.

## What is mean total number of steps taken per day?
For the next steps we will use the *ggplot* and *dplyr* packages. we will load 
them with `library()` function.
```{r, echo = TRUE, cache = TRUE, message = FALSE}
library(dplyr)
library(ggplot2)
```
Now we will plot a histogram of the total number of steps taken each day. To do 
this, we will first create another data set with the total number of steps for
each day. We will use the `group_by()` and `summarise()` functions from the *dplyr*
package, and we will assign the new data set to the object `data_sum`:
```{r, echo = TRUE, cache = TRUE}
data_sum <- data %>% group_by(date) %>% summarise(steps = sum(steps, na.rm = TRUE))
head(data_sum)
```
Now we will create a histogram with `ggplot()`
```{r, echo = TRUE, cache = TRUE, fig.align = 'center', fig.width = 7, fig.height = 5}
g <- ggplot(data_sum, aes(x = date, y = steps), na.rm = TRUE)
g + geom_col(fill = "navyblue", alpha = 0.6) +
        labs(title = "Total Steps per Day", 
             x = "Date", y = "Number of steps") +
        theme_bw()
```
Now we will calculate the mean and median with the `mean()` and `median()`
function.
```{r, echo = TRUE}
median(data_sum$steps)
mean(data_sum$steps)
```
The median total number of daily steps was 10,395 and the mean total number of 
daily steps was 9354.23. It would be better to visualize this data on the previous 
plot.
```{r, echo = TRUE, cache = TRUE, fig.align = 'center', fig.width = 7, fig.height = 5}
g <- ggplot(data_sum, aes(x = date, y = steps), na.rm = TRUE)
g + geom_col(fill = "navyblue", alpha = 0.6) +
        labs(title = "Total Steps per Day", 
             x = "Date", y = "Number of steps") +
  geom_hline(aes(yintercept = mean(steps), colour = "Mean"), 
             linetype = "dashed") +
  geom_hline(aes(yintercept = median(steps), colour = "Median"), 
             linetype = "dashed") +
  scale_colour_manual(values = c("Median" = "black", "Mean" = "red")) +
        theme_bw()
```

## What is the average daily activity pattern?

First we will filter out any NA value, to avoid troubles. Then, we will create a
data set called `data_mean` with the median total steps for each day:
```{r, echo = TRUE, cache = TRUE}
data2 <- data %>% filter(!is.na(steps))
interval_mean <- data2 %>%
        group_by(interval) %>% summarise(mean = mean(steps, na.rm = TRUE))
head(interval_mean)
```
Let's create a time series plot, with the 5-minute interval on the x-axis, and
the average number of steps taken, averaged across all day on the y-axis.
```{r, echo = TRUE, cache = TRUE, fig.align = 'center', fig.width = 7, fig.height = 5}
t <- ggplot(interval_mean, aes(x = interval, y = mean))
t + geom_line() +
  labs(title = "Average number of steps taken across all 5-minute intervals", 
       x = "5-minute interval", y = "Averaged number of steps") + 
  theme_bw()
```
Let's see which 5-minute interval contains the maximum number of steps, using the
`max()` function, to get the largest value from the mean column, and the `which()`
function, to find the corresponding 5-minute interval.
```{r, echo = TRUE, cache = TRUE}
max(interval_mean$mean)
which(interval_mean$mean == max(interval_mean$mean))
interval_mean[which(interval_mean$mean == max(interval_mean$mean)), ]
```
## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
